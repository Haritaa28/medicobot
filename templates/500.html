{% extends "layout.html" %}

{% block title %}Server Error - MedicoBot{% endblock %}

{% block content %}
<div class="error-container">
    <div class="error-content">
        <div class="error-icon">
            <i class="fas fa-server"></i>
        </div>
        <h1>500</h1>
        <h2>Internal Server Error</h2>
        <p>Something went wrong on our end. Please try again later or contact support if the problem persists.</p>

        <div class="error-details">
            <p><strong>What you can do:</strong></p>
            <ul>
                <li>Refresh the page</li>
                <li>Try again in a few minutes</li>
                <li>Clear your browser cache</li>
                <li>Contact our support team</li>
            </ul>
        </div>

        <div class="error-actions">
            <a href="{{ url_for('index') }}" class="btn btn-primary">
                <i class="fas fa-home"></i> Go Home
            </a>
            <button class="btn btn-secondary" onclick="window.location.reload()">
                <i class="fas fa-redo"></i> Refresh Page
            </button>
            <a href="mailto:support@medicobot.com" class="btn btn-secondary">
                <i class="fas fa-envelope"></i> Contact Support
            </a>
        </div>

        <div class="error-status">
            <p><i class="fas fa-info-circle"></i> System Status: <span id="systemStatus">Checking...</span></p>
            <p><i class="fas fa-clock"></i> Time: <span id="currentTime">{{ now().strftime('%Y-%m-%d %H:%M:%S') }}</span></p>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        checkSystemStatus();

        // Update time every second
        setInterval(updateTime, 1000);
    });

    async function checkSystemStatus() {
        try {
            const response = await fetch('/api/status');
            const data = await response.json();

            const statusElement = document.getElementById('systemStatus');

            if (data.offline_mode) {
                statusElement.textContent = 'Offline Mode';
                statusElement.style.color = '#ff944d';
            } else {
                let services = [];
                if (data.gemini_api) services.push('AI');
                if (data.translation_api) services.push('Translation');

                if (services.length > 0) {
                    statusElement.textContent = `Online (${services.join(', ')})`;
                    statusElement.style.color = '#4dff4d';
                } else {
                    statusElement.textContent = 'Limited Services';
                    statusElement.style.color = '#ffd24d';
                }
            }
        } catch (error) {
            document.getElementById('systemStatus').textContent = 'Unable to check';
            document.getElementById('systemStatus').style.color = '#ff4d4d';
        }
    }

    function updateTime() {
        const now = new Date();
        const timeString = now.toISOString().replace('T', ' ').substring(0, 19);
        document.getElementById('currentTime').textContent = timeString;
    }
</script>

<style>
    .error-container {
        min-height: 70vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 40px 20px;
    }

    .error-content {
        text-align: center;
        max-width: 600px;
        padding: 40px;
        background: white;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0,0,0,0.1);
    }

    .error-icon {
        font-size: 5rem;
        color: #ff4d4d;
        margin-bottom: 20px;
    }

    .error-content h1 {
        font-size: 6rem;
        color: #2c3e50;
        margin: 0;
        line-height: 1;
    }

    .error-content h2 {
        font-size: 2rem;
        color: #555;
        margin: 10px 0 20px;
    }

    .error-content p {
        color: #666;
        font-size: 1.1rem;
        margin-bottom: 30px;
        line-height: 1.6;
    }

    .error-details {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 10px;
        margin-bottom: 30px;
        text-align: left;
    }

    .error-details p {
        margin-bottom: 10px;
        font-weight: 600;
        color: #2c3e50;
    }

    .error-details ul {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .error-details li {
        padding: 5px 0;
        color: #666;
        position: relative;
        padding-left: 25px;
    }

    .error-details li:before {
        content: 'âœ“';
        position: absolute;
        left: 0;
        color: #43e97b;
        font-weight: bold;
    }

    .error-actions {
        display: flex;
        gap: 15px;
        justify-content: center;
        margin-bottom: 30px;
        flex-wrap: wrap;
    }

    .error-status {
        margin-top: 30px;
        padding-top: 30px;
        border-top: 1px solid #e0e0e0;
        text-align: left;
        max-width: 400px;
        margin-left: auto;
        margin-right: auto;
    }

    .error-status p {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin: 10px 0;
        font-size: 0.95rem;
    }

    .error-status i {
        color: #667eea;
        width: 20px;
    }

    .error-status span {
        font-weight: 600;
    }

    @media (max-width: 768px) {
        .error-content h1 {
            font-size: 4rem;
        }

        .error-content h2 {
            font-size: 1.5rem;
        }

        .error-actions {
            flex-direction: column;
        }

        .error-status p {
            flex-direction: column;
            align-items: flex-start;
            gap: 5px;
        }
    }
</style>
{% endblock %}